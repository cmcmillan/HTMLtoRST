#! /usr/bin/env python
# -*- coding: utf-8 -*-

## {{{ http://code.activestate.com/recipes/572160/ (r1)
import cStringIO
import ho.pisa as pisa
import os
import urllib2

# Shortcut for dumping all logs on screen
pisa.showLogging()

def URL2PDF(url, fileName, openFile=False):
    
    page = urllib2.urlopen(url)
    data = page.read()
    
    return HTML2PDF(data, fileName, openFile)

def HTML2PDF(data, fileName, openFile=False):
    """
    Simple test showing how to create a PDF file from
    PML Source String. Also shows errors and tries to start
    the resulting PDF
    """

    # Shortcut for dumping all logs on screen
    pisa.showLogging()

    with open(fileName,"wb") as pdfFile:
        pdf = pisa.CreatePDF(
                            cStringIO.StringIO(data),
                            pdfFile)
        pdfFile.flush()
        pdfFile.close()

    if openFile and ( not pdf.err ):
        #os.startfile( str( fileName ) )
        pisa.startViewer( str( fileName ) )

    return not pdf.err



if __name__=="__main__":
    TEST_URL = "http://docutils.sourceforge.net/docs/ref/rst/restructuredtext.html" 
    HTMLTEST = """
    <html>
        <header>
            <table width="100%">
                <tr>
                    <td align="center">
                    The Business Data Catalog
                    </td>
                </tr>
            <table>
        </header>
    </html>
    """
    HTMLTEST2 = """
    <html>
        <body>
            <table>
                <tr>
                    <td align="center">
                    The Business Data Catalog
                    </td>
                </tr>
            <table>
        </body>
    </html>
    """
    HTMLTEST3 = """
    <html><body>
    <p>Hello <strong style="color: #f00;">World</strong>
    <hr>
        <table border="1" style="background: #eee; padding: 0.5em;">
            <tr>
                <td>Amount</td>
                <td>Description</td>
                <td>Total</td>
            </tr>
            <tr>
                <td>1</td>
                <td>Good weather</td>
                <td>0 EUR</td>
            </tr>
            <tr style="font-weight: bold">
                <td colspan="2" align="right">Sum</td>
                <td>0 EUR</td>
            </tr>
        </table>
    </body></html>
    """
    HTMLTEST4 = """<html><body>
    You are here: <a href="http://www.endusersharepoint.com">Home</a> / <a href="http://www.endusersharepoint.com/category/out-of-box-solutions/" title="View all posts in Out of the Box Solutions">Out of the Box Solutions</a> / <a href="http://www.endusersharepoint.com/category/out-of-box-solutions/calculated-column/" title="View all posts in Calculated Column">Calculated Column</a> / SharePoint Media Center Additional Play Functionality</div>					
						
            <div class="headline">
                                     <div style="color: rgb(51, 51, 51);"><strong>Wednesday, February 24, 2010</strong></div>
            
                <div class="headlineleft"><h1>SharePoint Media Center Additional Play Functionality</h1></div>
            
                <!-- div class="headlineright">
                
                    <p><a href="http://www.endusersharepoint.com/2010/02/24/sharepoint-media-center-additional-play-functionality/#respond">14</a></p>
                    
                </div -->
                
            </div>
            <div class="comments_displaycount"><a href="http://www.endusersharepoint.com/2010/02/24/sharepoint-media-center-additional-play-functionality/#displayallcomments">Comments: 14</a></div>
            <div class="clear"></div>
									
            <p><img src="/blog/wp-content/uploads/2010/02/2010-02-18-SPMediaCenterAdditionalPlayFunctionality-01.jpg" class="alignleft" width="100" border="0" height="100">Guest Authors: <strong>Joan Resnick Ehrlich </strong>and<strong> Gerard J.   Pinzone</strong></p>
            
            <p><strong><em>Joan:</em></strong> We use WSS 3.0 for our Intranet and our setup is pretty  much out of the box server-side. Gerard wanted help in setting up a way to host  training related FLV video files on SharePoint and provide a SharePoint list which  utilizes sorting, filtering, and grouping on metadata. I had previously set up a  “media center” list to host access to WMV (Windows Media Player) files stored  on one of our file servers, and I thought the same solution would also work for  Gerard’s needs. </p>
            <p>My list is based on Mark’s “SharePoint Multimedia Center" setup, which uses Lytebox and Christophe Humbert’s Text-to -HTML script (<a href="http://www.endusersharepoint.com/2009/06/17/5-minute-screencast-create-a-multimedia-center-in-sharepoint/"><strong>5  Minute Screencast: Create a Multimedia Center in SharePoint</strong></a>), and the  related solution that Kevin Hughes worked out for his scenario (<a onclick="javascript:pageTracker._trackPageview('/outgoing/www.sharepointkevin.com/Lists/Posts/Post.aspx?ID=18');" href="http://www.sharepointkevin.com/Lists/Posts/Post.aspx?ID=18" target="_blank"><strong>Creating a  user-friendly media library using Lytebox</strong></a>), which uses a script to  dynamically load the chosen WMV file in an embedded Windows Media Player (WMP).  The page used to embed WMP is an aspx page without the Master Page attached,  created using SharePoint Designer. (More on that later.)</p>
            <p>After uploading the FLV files to the file server and  duplicating my list setup, I ran into several issues trying to play the files.  First, Windows Server 2003 IIS 6.0 requires a MIME type be added for FLV files  to be recognized as streamed media, as documented here: <a onclick="javascript:pageTracker._trackPageview('/outgoing/kb2.adobe.com/cps/194/tn_19439.html');" href="http://kb2.adobe.com/cps/194/tn_19439.html" target="_blank"><strong>Windows 2003 Server does not  stream FLV videos</strong></a>. As I am the IT admin and have control over IIS that was  an easy fix to implement. </p>
            <p>Second, although the latest versions of Windows Media Player  will play FLV files, the FLV file type is primarily associated with Flash, not  WMP. Launching an FLV file generated the “Windows cannot open this file…”  error. I did not want to change any file type associations, so my fix was to  use an FLV player. I downloaded the free <a onclick="javascript:pageTracker._trackPageview('/outgoing/www.longtailvideo.com/players/jw-flv-player/');" href="http://www.longtailvideo.com/players/jw-flv-player/" target="_blank"><strong>JW Player 5</strong></a> from  Longtail Video and uploaded the player files to the site resources library. To  test the player, I created a webpage, embedded the FLV player into a Content  Editor Web Part (CEWP), and used a hard coded path to one of the FLV files.  (Longtail Video has a wizard to help generate the necessary embed code.)&nbsp; The file played successfully.</p>
            
            <p>However, the FLV files did not play when launched from the list.  The Lytebox opened, but the FLV player did not launch. I realized I needed  different scripting, to handle JW Player instead of WMP. Here’s where Gerard  stepped in. He wrote the necessary script, and took the solution several steps  further.</p>
            <p><strong><em>Gerard:</em></strong> The script had to handle three of the most popular video  formats in use on the web: FLV, WMV, and MOV.&nbsp;  All three formats require different methods of playback.&nbsp; The script also had to provide the desired  video height and width to the player. In addition, I decided to handle some  issues between Lytebox and Internet Explorer (IE), which I provide at the end  of this article. The goal was to create a system that would be transparent to  the user and work seamlessly for all formats.</p>
            <p>To handle the different formats: <a onclick="javascript:pageTracker._trackPageview('/outgoing/www.longtailvideo.com/players/jw-flv-player/');" href="http://www.longtailvideo.com/players/jw-flv-player/" target="_blank"><strong>JW Player 5</strong></a> uses  JavaScript to dynamically create a container with all the appropriate settings  and inserts the result in a &lt;DIV&gt;  block.&nbsp; I used this method as a template  for all of the video containers.&nbsp; This provides  consistency across all formats and lowers the odds that an upgrade to JW Player  will require adjustments to the code.</p>
            
            <p>To handle height and width: I added two columns, named  height and width, to the SharePoint list to contain the desired values for each  video. I handled blank values by providing defaults in the script if no values  were passed. The various media players require an additional amount of height  for the player’s controls.&nbsp; Windows Media  Player needs 46 pixels, QuickTime needs 16 pixels, and JW Player needs 24  pixels.&nbsp; I have automated this by  determining the player needed for each file extension and increasing the height  accordingly. If additional file formats or changes to the size of the controls  occur, the offset values will need to be adjusted in the list’s calculated  column formula (provided later) and in the script.</p>
            <p>Lastly, we needed a way of parsing multiple variables from a  URL. &nbsp;(The URL in our case is obtained  from the list’s calculated column.) A Google search uncovered the JavaScript getValue function from this site: <a onclick="javascript:pageTracker._trackPageview('/outgoing/www.tek-tips.com/faqs.cfm?fid=5442');" href="http://www.tek-tips.com/faqs.cfm?fid=5442" target="_blank"><strong>http://www.tek-tips.com/faqs.cfm?fid=5442</strong></a>.</p>
            <p>I chose to place the script in an html page (named  videoplayer.html) rather than an aspx page. Writing the page from scratch  allowed me to have complete control over how the embedded video would be  displayed. The goal was to get the video, and just the video, tightly inside  the Lytebox iframe.<strong> &nbsp;</strong>The final code including the html code for  the page is shown below.&nbsp; (To create the  html page, copy and paste the code into a text editor and save the file with a .html extension. Then upload the html  file to your chosen SharePoint library.)</p>
            
            <p>Lines 17 and 90 of the script will  change based on the location of the swfobject.js  and player.swf files on your  SharePoint site.</p>
            <div class="syntaxhighlighter  xml" id="highlighter_102193"><div class="bar                                                                                                                        "><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_102193_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_102193" menu="false" src="http://www.endusersharepoint.com/blog/wp-content/plugins/syntaxhighlighter/syntaxhighlighter/scripts/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>001</code></td><td class="content"><code class="xml plain">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>002</code></td><td class="content"><code class="xml plain">"<a href="http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd</a>"&gt;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>003</code></td><td class="content"><code class="xml plain">&lt;</code><code class="xml keyword">html</code> <code class="xml color1">xmlns</code><code class="xml plain">=</code><code class="xml string">"<a href="http://www.w3.org/1999/xhtml">http://www.w3.org/1999/xhtml</a>"</code><code class="xml plain">&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>004</code></td><td class="content"><code class="xml plain">&lt;</code><code class="xml keyword">head</code><code class="xml plain">&gt;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>005</code></td><td class="content"><code class="xml plain">&lt;</code><code class="xml keyword">title</code><code class="xml plain">&gt;&lt;/</code><code class="xml keyword">title</code><code class="xml plain">&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>006</code></td><td class="content"><code class="xml plain">&lt;</code><code class="xml keyword">style</code> <code class="xml color1">type</code><code class="xml plain">=</code><code class="xml string">"text/css"</code><code class="xml plain">&gt;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>007</code></td><td class="content"><code class="xml plain">/*</code><code class="xml color2">&lt;![CDATA[*/</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>008</code></td><td class="content"><code class="xml color2">&lt;!--</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>009</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>010</code></td><td class="content"><code class="xml color2">body { margin: 0 auto; padding: 0px; }</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>011</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>012</code></td><td class="content"><code class="xml color2">embed, object { margin: 0px; padding: 0px; }</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>013</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>014</code></td><td class="content"><code class="xml color2">--&gt;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>015</code></td><td class="content"><code class="xml color2">/*]]&gt;</code><code class="xml plain">*/</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>016</code></td><td class="content"><code class="xml plain">&lt;/</code><code class="xml keyword">style</code><code class="xml plain">&gt;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>017</code></td><td class="content"><code class="xml plain">&lt;</code><code class="xml keyword">script</code> <code class="xml color1">type</code><code class="xml plain">=</code><code class="xml string">'text/javascript'</code> <code class="xml color1">src</code><code class="xml plain">=</code><code class="xml string">'/sites/yoursite/yourlibrary/jwplayer/swfobject.js'</code><code class="xml plain">&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>018</code></td><td class="content"><code class="xml plain">&lt;/</code><code class="xml keyword">script</code><code class="xml plain">&gt;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>019</code></td><td class="content"><code class="xml plain">&lt;</code><code class="xml keyword">script</code> <code class="xml color1">type</code><code class="xml plain">=</code><code class="xml string">'text/javascript'</code><code class="xml plain">&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>020</code></td><td class="content"><code class="xml plain">//</code><code class="xml color2">&lt;![CDATA[</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>021</code></td><td class="content"><code class="xml color2">function getValue(varname) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>022</code></td><td class="content"><code class="xml color2">// First, we load the URL into a variable</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>023</code></td><td class="content"><code class="xml color2">var url = window.location.href;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>024</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>025</code></td><td class="content"><code class="xml color2">// Next, split the url by the ?</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>026</code></td><td class="content"><code class="xml color2">var qparts = url.split("?");</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>027</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>028</code></td><td class="content"><code class="xml color2">// Check that there is a querystring, return "" if not</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>029</code></td><td class="content"><code class="xml color2">if (qparts.length == 0) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>030</code></td><td class="content"><code class="xml color2">return "";</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>031</code></td><td class="content"><code class="xml color2">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>032</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>033</code></td><td class="content"><code class="xml color2">// Then find the querystring, everything after the ?</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>034</code></td><td class="content"><code class="xml color2">var query = qparts[1];</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>035</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>036</code></td><td class="content"><code class="xml color2">// Split the query string into variables (separates by &amp;s)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>037</code></td><td class="content"><code class="xml color2">var vars = query.split("&amp;");</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>038</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>039</code></td><td class="content"><code class="xml color2">// Initialize the value with "" as default</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>040</code></td><td class="content"><code class="xml color2">var value = "";</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>041</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>042</code></td><td class="content"><code class="xml color2">// Iterate through vars, checking each one for varname</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>043</code></td><td class="content"><code class="xml color2">for (i = 0; i &lt; vars.length; i++) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>044</code></td><td class="content"><code class="xml color2">// Split the variable by =, which splits name and value</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>045</code></td><td class="content"><code class="xml color2">var parts = vars[i].split("=");</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>046</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>047</code></td><td class="content"><code class="xml color2">// Check if the correct variable</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>048</code></td><td class="content"><code class="xml color2">if (parts[0] == varname) {</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>049</code></td><td class="content"><code class="xml color2">// Load value into variable</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>050</code></td><td class="content"><code class="xml color2">value = parts[1];</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>051</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>052</code></td><td class="content"><code class="xml color2">// End the loop</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>053</code></td><td class="content"><code class="xml color2">break;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>054</code></td><td class="content"><code class="xml color2">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>055</code></td><td class="content"><code class="xml color2">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>056</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>057</code></td><td class="content"><code class="xml color2">// Convert escape code</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>058</code></td><td class="content"><code class="xml color2">value = unescape(value);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>059</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>060</code></td><td class="content"><code class="xml color2">// Convert "+"s to " "s</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>061</code></td><td class="content"><code class="xml color2">value.replace(/\+/g, " ");</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>062</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>063</code></td><td class="content"><code class="xml color2">// Return the value</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>064</code></td><td class="content"><code class="xml color2">return value;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>065</code></td><td class="content"><code class="xml color2">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>066</code></td><td class="content"><code class="xml color2">//]]&gt;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>067</code></td><td class="content"><code class="xml plain">&lt;/</code><code class="xml keyword">script</code><code class="xml plain">&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>068</code></td><td class="content"><code class="xml plain">&lt;/</code><code class="xml keyword">head</code><code class="xml plain">&gt;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>069</code></td><td class="content"><code class="xml plain">&lt;</code><code class="xml keyword">body</code><code class="xml plain">&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>070</code></td><td class="content"><code class="xml plain">&lt;</code><code class="xml keyword">div</code> <code class="xml color1">id</code><code class="xml plain">=</code><code class="xml string">'mediaspace'</code><code class="xml plain">&gt;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>071</code></td><td class="content"><code class="xml plain">This text will be replaced</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>072</code></td><td class="content"><code class="xml plain">&lt;/</code><code class="xml keyword">div</code><code class="xml plain">&gt;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>073</code></td><td class="content"><code class="xml plain">&lt;</code><code class="xml keyword">script</code> <code class="xml color1">type</code><code class="xml plain">=</code><code class="xml string">'text/javascript'</code><code class="xml plain">&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>074</code></td><td class="content"><code class="xml plain">//</code><code class="xml color2">&lt;![CDATA[</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>075</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>076</code></td><td class="content"><code class="xml color2">var vidplayer_filename = getValue('name');</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>077</code></td><td class="content"><code class="xml color2">var vidplayer_width = parseInt(getValue('width'));</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>078</code></td><td class="content"><code class="xml color2">var vidplayer_height = parseInt(getValue('height'));</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>079</code></td><td class="content"><code class="xml color2">var vidplayer_filetype = vidplayer_filename.substr(vidplayer_filename.lastIndexOf('.')).toLowerCase();</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>080</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>081</code></td><td class="content"><code class="xml color2">if (vidplayer_filetype == '.flv') {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>082</code></td><td class="content"><code class="xml color2">var vidplayer_preview = getValue('preview');</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>083</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>084</code></td><td class="content"><code class="xml color2">if (!vidplayer_width) vidplayer_width = 320;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>085</code></td><td class="content"><code class="xml color2">if (!vidplayer_height) vidplayer_height = 240;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>086</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>087</code></td><td class="content"><code class="xml color2">// add 24 pixels to height for Controls</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>088</code></td><td class="content"><code class="xml color2">vidplayer_height += 24;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>089</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>090</code></td><td class="content"><code class="xml color2">var so = new SWFObject('/sites/yoursite/yourlibrary/jwplayer/player.swf', 'mpl', vidplayer_width, vidplayer_height, '9');</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>091</code></td><td class="content"><code class="xml color2">so.addParam('allowfullscreen', 'true');</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>092</code></td><td class="content"><code class="xml color2">so.addParam('allowscriptaccess', 'always');</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>093</code></td><td class="content"><code class="xml color2">so.addParam('wmode', 'opaque');</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>094</code></td><td class="content"><code class="xml color2">so.addVariable('file', vidplayer_filename);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>095</code></td><td class="content"><code class="xml color2">so.addVariable('image', vidplayer_preview);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>096</code></td><td class="content"><code class="xml color2">so.addVariable('autostart', 'true');</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>097</code></td><td class="content"><code class="xml color2">so.write('mediaspace');</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>098</code></td><td class="content"><code class="xml color2">} else if (vidplayer_filetype == '.mov') {</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>099</code></td><td class="content"><code class="xml color2">if (!vidplayer_width) vidplayer_width = 320;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>100</code></td><td class="content"><code class="xml color2">if (!vidplayer_height) vidplayer_height = 240;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>101</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>102</code></td><td class="content"><code class="xml color2">// add 16 pixels to height for Controls</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>103</code></td><td class="content"><code class="xml color2">vidplayer_height += 16;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>104</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>105</code></td><td class="content"><code class="xml color2">var mov = '&lt;OBJECT classid="clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B" width="' + vidplayer_width + '" height="' + vidplayer_height + '" codebase="<a href="http://www.apple.com/qtactivex/qtplugin.cab">http://www.apple.com/qtactivex/qtplugin.cab</a>"&gt;';</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>106</code></td><td class="content"><code class="xml color2">mov += '&lt;param name="src" value="' + vidplayer_filename + '"&gt;';</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>107</code></td><td class="content"><code class="xml color2">mov += '&lt;param name="autoplay" value="true"&gt;';</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>108</code></td><td class="content"><code class="xml color2">mov += '&lt;param name="controller" value="true"&gt;';</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>109</code></td><td class="content"><code class="xml color2">mov += '&lt;param name="loop" value="false"&gt;';</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>110</code></td><td class="content"><code class="xml color2">mov += '&lt;param name="scale" value="aspect"&gt;';</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>111</code></td><td class="content"><code class="xml color2">mov += '&lt;EMBED src="' + vidplayer_filename + '" width="' + vidplayer_width + '" height="' + vidplayer_height + '" scale="aspect" autoplay="true" controller="true" loop="false" pluginspage="<a href="http://www.apple.com/quicktime/download/">http://www.apple.com/quicktime/download/</a>"&gt;&lt;\/EMBED&gt;';</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>112</code></td><td class="content"><code class="xml color2">mov += '&lt;\/OBJECT&gt;';</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>113</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>114</code></td><td class="content"><code class="xml color2">document.getElementById('mediaspace').innerHTML = mov;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>115</code></td><td class="content"><code class="xml color2">} else {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>116</code></td><td class="content"><code class="xml color2">// Override lytebox.js end function to stop video playback when closed</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>117</code></td><td class="content"><code class="xml color2">if (parent.myLytebox) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>118</code></td><td class="content"><code class="xml color2">parent.myLytebox.end = function(caller) {</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>119</code></td><td class="content"><code class="xml color2">var closeClick = (caller == 'slideshow' ? false : true);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>120</code></td><td class="content"><code class="xml color2">if (this.isSlideshow &amp;&amp; this.isPaused &amp;&amp; !closeClick) {</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>121</code></td><td class="content"><code class="xml color2">return;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>122</code></td><td class="content"><code class="xml color2">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>123</code></td><td class="content"><code class="xml color2">this.disableKeyboardNav();</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>124</code></td><td class="content"><code class="xml color2">this.doc.getElementById('lbMain').style.display = 'none';</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>125</code></td><td class="content"><code class="xml color2">this.fade('lbOverlay', (this.doAnimations ? this.maxOpacity : 0));</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>126</code></td><td class="content"><code class="xml color2">this.toggleSelects('visible');</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>127</code></td><td class="content"><code class="xml color2">if (this.hideFlash) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>128</code></td><td class="content"><code class="xml color2">this.toggleFlash('visible');</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>129</code></td><td class="content"><code class="xml color2">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>130</code></td><td class="content"><code class="xml color2">if (this.isSlideshow) {</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>131</code></td><td class="content"><code class="xml color2">for (var i = 0; i &lt; this.slideshowIDCount; i++) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>132</code></td><td class="content"><code class="xml color2">window.clearTimeout(this.slideshowIDArray[i]);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>133</code></td><td class="content"><code class="xml color2">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>134</code></td><td class="content"><code class="xml color2">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>135</code></td><td class="content"><code class="xml color2">if (this.isLyteframe) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>136</code></td><td class="content"><code class="xml color2">// Inserted by G. Pinzone to stop playback of WMV files if Lytebox iframe is closed</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>137</code></td><td class="content"><code class="xml color2">try {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>138</code></td><td class="content"><code class="xml color2">var videoPlayer = this.doc.getElementById('lbIframe').contentWindow.document.getElementById('MediaPlayer');</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>139</code></td><td class="content"><code class="xml color2">if (videoPlayer) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>140</code></td><td class="content"><code class="xml color2">videoPlayer.stop();</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>141</code></td><td class="content"><code class="xml color2">//videoPlayer.removeNode(true);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>142</code></td><td class="content"><code class="xml color2">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>143</code></td><td class="content"><code class="xml color2">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>144</code></td><td class="content"><code class="xml color2">catch(e) {}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>145</code></td><td class="content"><code class="xml color2">// End</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>146</code></td><td class="content"><code class="xml color2">this.initialize();</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>147</code></td><td class="content"><code class="xml color2">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>148</code></td><td class="content"><code class="xml color2">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>149</code></td><td class="content"><code class="xml color2">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>150</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>151</code></td><td class="content"><code class="xml color2">if (!vidplayer_width) vidplayer_width = 320;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>152</code></td><td class="content"><code class="xml color2">if (!vidplayer_height) vidplayer_height = 240;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>153</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>154</code></td><td class="content"><code class="xml color2">// add 46 pixels to height for ShowControls, 26 pixels for ShowStausBar, and 74 for ShowDisplay</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>155</code></td><td class="content"><code class="xml color2">vidplayer_height += 46;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>156</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>157</code></td><td class="content"><code class="xml color2">var wmv = '&lt;OBJECT ID="MediaPlayer" WIDTH="' + vidplayer_width + '" HEIGHT="' + vidplayer_height + '" CLASSID="CLSID:22D6F312-B0F6-11D0-94AB-0080C74C7E95" STANDBY="Loading Windows Media Player components..." TYPE="application/x-oleobject"&gt;';</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>158</code></td><td class="content"><code class="xml color2">wmv += '&lt;PARAM NAME="FileName" VALUE="' + vidplayer_filename + '"&gt;';</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>159</code></td><td class="content"><code class="xml color2">wmv += '&lt;PARAM name="autostart" VALUE="true"&gt;';</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>160</code></td><td class="content"><code class="xml color2">wmv += '&lt;PARAM name="ShowControls" VALUE="true"&gt;';</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>161</code></td><td class="content"><code class="xml color2">wmv += '&lt;PARAM name="ShowStatusBar" VALUE="false"&gt;';</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>162</code></td><td class="content"><code class="xml color2">wmv += '&lt;PARAM name="ShowDisplay" VALUE="false"&gt;';</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>163</code></td><td class="content"><code class="xml color2">wmv += '&lt;EMBED TYPE="application/x-mplayer2" SRC="' + vidplayer_filename + '" NAME="MediaPlayer" WIDTH="' + vidplayer_width + '" HEIGHT="' + vidplayer_height + '" ShowControls="1" ShowStatusBar="0" ShowDisplay="0" autostart="1"&gt; &lt;\/EMBED&gt;';</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>164</code></td><td class="content"><code class="xml color2">wmv += '&lt;\/OBJECT&gt;';</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>165</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>166</code></td><td class="content"><code class="xml color2">document.getElementById('mediaspace').innerHTML = wmv;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>167</code></td><td class="content"><code class="xml color2">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>168</code></td><td class="content"><code class="xml color2">//]]&gt;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>169</code></td><td class="content"><code class="xml plain">&lt;/</code><code class="xml keyword">script</code><code class="xml plain">&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>170</code></td><td class="content"><code class="xml plain">&lt;/</code><code class="xml keyword">body</code><code class="xml plain">&gt;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>171</code></td><td class="content"><code class="xml plain">&lt;/</code><code class="xml keyword">html</code><code class="xml plain">&gt;</code></td></tr></tbody></table></div></div></div>
            
            <p>The basic format of the URL used in this script is:<br>
              http://<em> sharepoint-path-to-file</em>/<em>videoplayer.</em>html?name=<em>url-to-video.flv</em>&amp;height=<em>XXX</em>&amp;width=<em>YYY</em></p>
            <h3>Creating the player  links in the SharePoint list’s calculated column</h3>
            
            <p>Expanding on the list’s calculated column, the concatenate  command below constructs the necessary html to include the height and width in  the URL that is passed to the script, and display a “Download” icon next to the  “Play” icon.&nbsp; The “Play” icon will  trigger the Lytebox iframe, while the download simply links to the source file  automatically.</p>
            <div class="syntaxhighlighter  xml" id="highlighter_375153"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_375153_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_375153" menu="false" src="http://www.endusersharepoint.com/blog/wp-content/plugins/syntaxhighlighter/syntaxhighlighter/scripts/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="xml plain">=CONCATENATE("&lt;</code><code class="xml keyword">DIV</code><code class="xml plain">&gt;&lt;</code><code class="xml keyword">a</code> <code class="xml color1">href</code><code class="xml plain">=</code><code class="xml string">'/sites/yoursite/yourlibrary/yourfile.html?name=",FileName,"&amp;width=",width,"&amp;height=",height,"'</code> <code class="xml color1">rel</code><code class="xml plain">=</code><code class="xml string">'lyteframe'</code> <code class="xml color1">title</code><code class="xml plain">=</code><code class="xml string">'Stop video before closing window'</code> <code class="xml color1">rev</code><code class="xml plain">=</code><code class="xml string">'width:",width,"px",";","height:", IF(LOWER(RIGHT(FileName,4))=".flv",height+24,IF(LOWER(RIGHT(FileName,4))=".mov",height+16,height+46)),"px",";scrolling: no;'</code><code class="xml plain">&gt;","&lt;</code><code class="xml keyword">img</code> <code class="xml color1">src</code><code class="xml plain">=</code><code class="xml string">'/sites/yoursite/yourlibrary/yourplayVideo.gif'</code> <code class="xml color1">style</code><code class="xml plain">=</code><code class="xml string">'vertical-align: middle'</code> <code class="xml color1">border</code><code class="xml plain">=</code><code class="xml string">'0'</code> <code class="xml color1">width</code><code class="xml plain">=</code><code class="xml string">'32'</code> <code class="xml color1">height</code><code class="xml plain">=</code><code class="xml string">'32'</code> <code class="xml color1">title</code><code class="xml plain">=</code><code class="xml string">'Click to stream video'</code> <code class="xml color1">alt</code><code class="xml plain">=</code><code class="xml string">'Play Icon'</code> <code class="xml plain">/&gt;","&lt;/</code><code class="xml keyword">a</code><code class="xml plain">&gt;&lt;</code><code class="xml keyword">span</code> <code class="xml color1">style</code><code class="xml plain">=</code><code class="xml string">'vertical-align: middle;padding: 0 6px 0 6px'</code><code class="xml plain">&gt;/&lt;/</code><code class="xml keyword">span</code><code class="xml plain">&gt;&lt;</code><code class="xml keyword">a</code> <code class="xml color1">href</code><code class="xml plain">=</code><code class="xml string">",FileName,"</code><code class="xml plain">&gt;&lt;</code><code class="xml keyword">img</code> <code class="xml color1">src</code><code class="xml plain">=</code><code class="xml string">'/sites/yoursite/yourlibrary/yourdownload.gif'</code> <code class="xml color1">style</code><code class="xml plain">=</code><code class="xml string">'vertical-align: middle'</code> <code class="xml color1">border</code><code class="xml plain">=</code><code class="xml string">'0'</code> <code class="xml color1">width</code><code class="xml plain">=</code><code class="xml string">'32'</code> <code class="xml color1">height</code><code class="xml plain">=</code><code class="xml string">'32'</code> <code class="xml color1">title</code><code class="xml plain">=</code><code class="xml string">'Click to download video'</code> <code class="xml color1">alt</code><code class="xml plain">=</code><code class="xml string">'D/L Icon'</code> <code class="xml plain">/&gt;&lt;/</code><code class="xml keyword">a</code><code class="xml plain">&gt;&lt;/</code><code class="xml keyword">DIV</code><code class="xml plain">&gt;")</code></td></tr></tbody></table></div></div></div>
            
            <p>The items “yoursite”, “yourlibrary”, and “yourfile/playVideo/download” will need to be modified based on the  structure of your SharePoint site and the icons used.</p>
            <h3>Lytebox and Internet  Explorer<br>
              Patching Lytebox.js</h3>
            <p>Displaying the video “on top of” the existing SharePoint  page is accomplished by using <a onclick="javascript:pageTracker._trackPageview('/outgoing/www.dolem.com/lytebox/');" href="http://www.dolem.com/lytebox/" target="_blank"><strong>Lytebox  3.22</strong></a>.&nbsp; Lytebox hasn’t been officially  updated since October 2007. IE browsers using Lytebox do not provide the  correct width or height to the page being displayed in a “lyteframe.”&nbsp; Therefore, I patched the changeContent code in the lytebox.js file:</p>
            <div class="syntaxhighlighter  xml" id="highlighter_16235"><div class="bar     "><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_16235_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_16235" menu="false" src="http://www.endusersharepoint.com/blog/wp-content/plugins/syntaxhighlighter/syntaxhighlighter/scripts/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="xml plain">if (this.isLyteframe) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="xml plain">var iframe = myLytebox.doc.getElementById('lbIframe');</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="xml plain">var styles = this.frameArray[this.activeFrame][2];</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="xml plain">var aStyles = styles.split(';');</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="xml plain">for (var i = 0; i &lt; </code><code class="xml keyword">aStyles.length</code><code class="xml plain">; i++) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">if (aStyles[i].indexOf('width:') &gt;= 0) {</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">var w = aStyles[i].replace('width:', '');</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">iframe.width = parseInt(w.trim()) + (this.ie ? 6 : 0);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">} else if (aStyles[i].indexOf('height:') &gt;= 0) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">var h = aStyles[i].replace('height:', '');</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">iframe.height = parseInt(h.trim()) + (this.ie ? 4 : 0);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">} else if (aStyles[i].indexOf('scrolling:') &gt;= 0) {</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">var s = aStyles[i].replace('scrolling:', '');</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>14</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">iframe.scrolling = s.trim();</code></td></tr></tbody></table></div></div></div>
            
            <p>This is considered a bug fix.&nbsp; The changes are applicable for all other uses  of lytebox on your site.&nbsp; </p>
            <p>Also, the animations work very slowly in IE browsers, so  it’s best to turn that feature off (i.e., this.doAnimations  = false;).</p>
            <h3>Stopping WMP audio  after the iframe is closed</h3>
            <p>Internet Explorer does not shut down videos embedded with  Windows Media Player (WMP) in an iframe when the iframe is closed.&nbsp; The iframe goes away, but the audio keeps  going until the end of the video is reached.&nbsp;  To fix this problem, lytebox needs to stop the video whenever the iframe  is closed.&nbsp; I accomplished this by  overriding the lytebox “end” function in my script whenever WMP is used in the videoplayer.html page.&nbsp; If a new lytebox.js  ever gets released with a modified “end” function, this portion may need to be  updated.</p>
            
            <p><img src="/blog/wp-content/uploads/2010/02/JoanResnickEhrlich.jpg" class="alignleft" width="100" border="0" height="75">Guest Author: <strong>Joan Resnick Ehrlich</strong></p>
            <p>Joan Resnick Ehrlich has been in the IT industry for 15 years and is Corporate IT Administrator for a mid-sized company on Long Island, NY. Prior to entering the industry Joan was a business researcher, and she enjoys combining her research skills with IT work. In addition to SharePoint, her primary responsibilities include Windows Server, Active Directory, Exchange Server, and SQL Server.</p>
            <p><img src="/blog/wp-content/uploads/2010/02/GerardPinzone.jpg" class="alignleft" width="100" border="0" height="75">Guest Author: <strong>Gerard J. Pinzone</strong></p>
            <p>Gerard J.   Pinzone works in the Product Assurance department of the same firm.&nbsp; He has over   20 years of software development work experience, specializing in   Process/Product Management, Configuration Management, Quality Assurance,   Computer Technology, and Engineering including ISO 9001 and CMMI certification.&nbsp;   Gerard had previously worked for the <strong><a onclick="javascript:pageTracker._trackPageview('/outgoing/www.mta.info/nyct/');" title="This external link will open in a new window" href="http://www.mta.info/nyct/" target="_blank">New York City Transit   Authority</a> </strong>as a Project   Manager/Senior Staff Scientist for all aspects of the <a onclick="javascript:pageTracker._trackPageview('/outgoing/en.wikipedia.org/wiki/MetroCard_%28New_York_City%29');" href="http://en.wikipedia.org/wiki/MetroCard_%28New_York_City%29" title="This external link will open in a new window" target="_blank"><strong>MetroCard</strong></a> fare system.<strong> <a onclick="javascript:pageTracker._trackPageview('/outgoing/www.linkedin.com/pub/gerard-pinzone/16/844/b23');" title="This external link will open in a new window" href="http://www.linkedin.com/pub/gerard-pinzone/16/844/b23" target="_blank">http://www.linkedin.com/pub/gerard-pinzone/16/844/b23</a>
            </body></html>
        """

    
    HTML2PDF(HTMLTEST, "test_header.pdf", openFile=True)
    HTML2PDF(HTMLTEST2, "test_body.pdf", openFile=True)
    #HTML2PDF(HTMLTEST2, "test.pdf", openFile=True)
    #URL2PDF(TEST_URL, "urltest.pdf", openFile=True)
## end of http://code.activestate.com/recipes/572160/ }}}

